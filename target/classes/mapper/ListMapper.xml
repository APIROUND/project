<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.ApiRound.mapper.ListMapper">

    <!-- 결과 매핑 -->
    <resultMap id="ListDtoResultMap" type="com.example.ApiRound.dto.ListDto">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="region" property="region"/>
        <result column="subregion" property="subregion"/>
        <result column="address" property="address"/>
        <result column="phone" property="phone"/>
        <result column="homepage" property="homepage"/>
        <result column="coord_x" property="coordX"/>
        <result column="coord_y" property="coordY"/>
        <result column="category" property="category"/>
    </resultMap>

    <!-- 전체 병원 리스트 조회 -->
    <select id="findAll" resultMap="ListDtoResultMap">
        SELECT
            id, name, region, subregion, address, phone, homepage,
            coord_x, coord_y, category
        FROM hospital_list
        ORDER BY id ASC
    </select>

    <!-- ID로 단일 병원 조회 -->
    <select id="findById" parameterType="long" resultMap="ListDtoResultMap">
        SELECT
            id, name, region, subregion, address, phone, homepage,
            coord_x, coord_y, category
        FROM hospital_list
        WHERE id = #{id}
    </select>

    <!-- 병원 등록 -->
    <insert id="insertList" parameterType="com.example.ApiRound.dto.ListDto">
        INSERT INTO hospital_list (
            name, region, subregion, address, phone, homepage,
            coord_x, coord_y, category
        ) VALUES (
            #{name}, #{region}, #{subregion}, #{address}, #{phone}, #{homepage},
            #{coordX}, #{coordY}, #{category}
        )
    </insert>

    <!-- 지역 + 카테고리별 병원 리스트 조회 -->
    <select id="findByRegionAndCategory" resultMap="ListDtoResultMap">
        SELECT
            id, name, region, subregion, address, phone, homepage,
            coord_x, coord_y, category
        FROM hospital_list
        WHERE region = #{region} AND category = #{category} .                 
        ORDER BY id ASC
    </select>

    <!-- 카테고리별 병원 리스트 조회 -->
    <select id="findByCategory" parameterType="string" resultMap="ListDtoResultMap">
        SELECT
            id, name, region, subregion, address, phone, homepage,
            coord_x, coord_y, category
        FROM hospital_list
        WHERE category = #{category}
        ORDER BY id ASC
    </select>


</mapper>
